# 1.3 저장소 계정 만들기
Azure 저장소 계정은 데이터를 저장하기 위한 공간입니다. 크게 **blob, 파일, 테이블, 큐**로 구성되어 있으며, 각각의 저장 성격이 다릅니다.

저장소 계정은 크게 범용 저장소 계정과 Blob 저장소 계정으로 나누어 지며, 각각 저장소의 특징은 다음과 같습니다.
- **범용 저장소 계정** : 위에서 설명한 blob, 파일, 테이블 큐를 가지는 일반적인 **표준 저장소 성능 계층**과, 가상 컴퓨터 디스크만 지원하는 **프리미엄 저장소 성능 계층**으로 나누어 집니다.
- **Blob 저장소 계정** : blob에 특화된 저장소 계정으로 자주 접근하는 **핫 엑서스 계층**으로 저렴한 접근 비용을 사용할 수 있으며, 가끔 접근하는 **쿨 엑서스 계층**으로 저렴한 데이터 저장 비용을 이점으로 가질 수 있습니다.

내구성 보장을 위해 **LRS(로컬 중복 복제)**, **ZRS(영역 중복 복제)**, **GRS(지역 중복 복제)**, **RA-GRS(읽기 전용 지역 중복 복제)** 로 설정이 가능합니다.

자세한 내용은 [Azure 문서](https://docs.microsoft.com/ko-kr/azure/storage/storage-introduction)를 참고하기 바랍니다.

이번 내용에서는 Azure 웹 콘솔로 저장소 계정을 만들어 보는 작업과 Azure CLI 2.0을 통해 저장소 계정을 만들어 보겠습니다.

## 웹 콘솔에서 저장소 계정 만들기
1. [Azure 웹 콘솔](https://portal.azure.com)에 접속합니다.

2. 좌측 메뉴에서 **저장소 계정**을 선택합니다.
    - 좌측 메뉴에 **저장소 계정**이 없다면, 하단의 More Service를 선택 한 후 **blobs**를 검색하여 선택합니다.

3. 블레이드에 **저장소 계정**창이 뜨면 상단에 **+추가**버튼을 눌러서 **저장소 계정**을 생성합니다.

4. **저장소 계정 만들기** 블레이드가 뜨면 아래와 같이 설정을 입력합니다.
    - `이름` : 표시될 저장소 계정 이름을 입력합니다. 모든 지역에서 유일해야 합니다. 저장소 계정이 생성되면 *<저장소 계정 이름>.core.windows.net* 으로 접근이 가능합니다.
    - `배포 모델` : 
        - `Resource Manager` : 현재 변경된 Azure 포털에 생성하는 것으로 최근 권장하는 설정입니다. 여기서는 **Resource Group**을 선택 하겠습니다.
        - `클래식` : 이전 Azure 포털에 생성하는 것으로 현재는 선택을 권장하지 않습니다.
    - `계정 종류` : 앞서 설명한 **범용 저장소 계정**과 **Blob 저장소 계정**을 선택합니다. 여기서는 **범용**을 선택 하겠습니다.
    
        > [!메모]
        >
        > **범용**을 선택하면 `성능`옵션을 사용할 수 있으며, **Blob 저장소**를 선택하면 `성능`옵션은 사용할 수 없게 되고 `액서스 계층`이라는 옵션이 추가로 생성 됩니다.

    - `성능` : 낲서 설명한 **범용 저장소 계정**에서 **성능**을 기준으로 **표준**과 **프리미엄**으로 나누어 집니다. 여기서는 **표준**을 선택 하겠습니다.
    
        > [!메모]
        >
        > **프리미엄**을 선택하면 `복제`옵션에서 LRS만 선택할 수 있습니다.

    - `복제` : 복제 설정 입니다. 여기서는 **LRS**를 선택 하겠습니다.
    - `저장소 서비스 암호화` : 저장소 계정을 암호화하는 설정입니다. 여기서는 **사용 안 함**을 선택 하겠습니다.
    - `구독` : 가상 네트워크를 생성할 구독을 선택합니다.
    - `리소스 그룹` :
        - 새로 만들기 : 생성할 **리소스 그룹 이름**을 입력합니다.
        - 기존 그룹 사용 : 이미 생성한 **리소스 그룹**이 있다면 해당 리소스 그룹을 선택합니다.
    - `위치` : 가상 네트워크를 생성할 지역을 선택합니다. 
    > [!메모]
    >
    > 리소스 그룹 메뉴에서 새로 만들기를 할 시 리소스 그룹도 동일한 지역에 생성됩니다.

5. 하단의 **만들기**를 클릭하여 **저장소 계정**을 생성합니다.

## Azure CLI 2.0으로 저장소 계정 만들기
1. 각 운영체제에 맞는 CLI 창을 실행 합니다.

2. 다음 명령을 사용하여 `Azure CLI 2.0`을 인증 합니다.
    ```Azurecli
    az login
    ```

3. 명령어 실행 후 웹 브라우저로 출력된 [URL](https://aka.ms/devicelogin)에 접속합니다.

4. **Devicr Login** 페이지가 뜨면 출력된 9자리의 코드를 복사하여 입력합니다.

5. **Microsoft Azure Cross-platform Command Line Interface** 라는 메세지와 함께 생성된 화면에서 **Continue**를 클릭합니다.

6. 로그인 창이 뜨면 Azure 계정으로 로그인 합니다.

7. **Microsoft Azure Cross-platform Command Line Interface** 이라는 메세지와 함께 인증이 완료되었다는 창이 뜨면 웹 브라우저를 닫고 다시 CLI 창으로 돌아오면 인증이 완료된 것을 확인할 수 있습니다.
    > [!메모]
    >
    > JSON형식으로 출력된 값이 두 개 이상인 경우 로그인 한 계정에 연결된 구독(subscription)이 두 개 이상인 경우 입니다. 이 때 아래와 같은 명령어를 사용하여 특정 구독을 사용하겠다는 정의를 별도로 해 주어야 합니다.
    > ```Azurecli
    > az account set --subscription "<Subscription ID>"
    > ```

8. 다음 명령을 사용하여 **저장소 계정**을 생성합니다.
    - 예제1: **범용 저장소 계정** 생성
    ```Azurecli
    az storage account create -n <표시 될 저장소 계정 이름, 모든 지역에서 유일해야 함> \
    -g <리소스 그룹 이름> \
    --sku <Premium_LRS, Standard_GRS, Standard_LRS, Standard_RAGRS, Standard_ZRS 중 하나> \
    -l <저장소 계정을 생성할 지역>
    ```

    - 예제2: **Blob 저장소 계정**
    ```Azurecli
    az storage account create -n <표시 될 저장소 계정 이름, 모든 지역에서 유일해야 함> \
    -g <리소스 그룹 이름> \
    --sku <Standard_GRS, Standard_LRS, Standard_RAGRS 중 하나> \
    --kind BlobStorage \
    --access-tier <Cool 또는 Hot> \
    -l <저장소 계정을 생성할 지역>
    ```

9. 다음 명령을 사용하여 생성된 **저장소 계정**을 확인합니다.
    - 예제1: **저장소 계정** 기본 조회
    ```Azurecli
    az storage account list
    ```

    - 예제2: **리소스 그룹**을 기준으로 **저장소 계정** 조회
    ```Azurecli
    az storage account list --g <리소스 그룹 이름>
    ```
